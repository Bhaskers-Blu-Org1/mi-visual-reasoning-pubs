\section{Experiments}

We analyze MAC's generalization and transfer learning abilities by testing it on the CLEVR-CoGenT dataset. It is synthesized in the same way as CLEVR, but contains two conditions: in Condition A, all cubes are gray, blue, brown, or yellow and all cylinders are red, green, purple, or cyan; in Condition B, cubes and cylinders swap color palettes. Both conditions contain spheres of all colors. We also evaluate the simplified model on this dataset for comparison.

The training procedure is layed out as follows: we train the MAC model (and simplified MAC) for 20 epochs on 90\% of the training sets of CLEVR \& CoGenT separately. We keep the remaining 10\% for validating the model at every epoch, and use the original validation sets as test sets, given that the ground truth labels for the true test sets are not available.

We implemented both versions of the MAC model using PyTorch v0.4.0~\cite{paszke2017automatic}. We relied on the MI-Prometheus~\cite{kornuta2018accelerating} framework for training and testing of both models\footnote{The code of models along with training settings are available on \url{https://github.com/IBM/mi-prometheus/}}. For training we have used NVIDIA's GeForce GTX TITAN X. We followed the implementation details indicated in the original paper~\cite{hudson2018compositional} (Section A of the supplementary material), to ensure a faithful comparison.

\begin{table}[]
	\caption{CLEVR \& CoGenT accuracies for the MAC \& simplified MAC models}
	\centering
	\begin{tabular}{cccccc}
		\toprule
		Model                 & Training set                & Training time [h] & Training acc [\%]          & Test set & Test acc [\%] \\
		\midrule
		\multirow{3}{*}{MAC}  & CLEVR                       & 31                                   & acc: 96.7                  & CLEVR    & 96.2          \\
		\cmidrule{2-6} 
		& \multirow{2}{*}{CoGenT-A} & \multirow{2}{*}{31}                    & \multirow{2}{*}{acc: 97.0} & CoGenT-A & 96.9         \\
		\cmidrule{5-6} 
		&                             &                                         &                              & CoGenT-B & 79.5          \\
		\midrule
		\multirow{3}{*}{SMAC} & CLEVR                       & 28                                     & acc: 95.8               & CLEVR    & 95.3          \\
		\cmidrule{2-6} 
		& \multirow{2}{*}{CoGenT-A}   & \multirow{2}{*}{28}                    & \multirow{2}{*}{acc: 96.1} & CoGenT-A & 95.9          \\
		\cmidrule{5-6} 
		&                             &                                         &                              & CogenT-B & 78.7          \\
		\bottomrule
	\end{tabular}
	\label{results}
\end{table}

We report the obtained scores in \tableref{results}. Taking the evaluation of MAC on CLEVR as a reference experiment, it yields an accuracy of 96.2\%, obtained after 31h of training.\vmf{Not sure if we should explain in more details why there's a 3\% gap..}
Evaluating MAC on CoGenT shows that, like previous work (\cite{johnson2017inferring}, \cite{mascharka2018transparency})], the performance is worse on Condition B than Condition A after training only using Condition A data. As \tableref{results} shows, the MAC model achieves 79.5\% accuracy on Condition B, which surpasses the previously 78.8\% reported in \cite{perez2017film}. 
The simplified MAC reaches an accuracy of 95.3\% on CLEVR, which is close to the reference score. Moreover, the simplified MAC presents the advantage to train faster, showing a decrease of ~10\% in wall time. This point also holds true when training on CoGenT: not only does the simplified model trains faster, it also presents comparable performance when evaluated on both conditions.


Following \cite{johnson2017inferring}, we then fine-tune both models using 3k images and 30k questions from the Condition B data.. \textit{To continue later on}.
